- name: Add chrome key
  become: yes
  apt_key:
    url: https://dl.google.com/linux/linux_signing_key.pub
- name: Add chrome repo
  become: yes
  apt_repository:
    repo: "deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main"
    filename: google-chrome
- name: Add MS key
  become: yes
  apt_key:
    url: https://packages.microsoft.com/keys/microsoft.asc
- name: Add VS Code repo
  become: yes
  apt_repository:
    repo: "deb [arch=amd64] http://packages.microsoft.com/repos/vscode stable main"
    filename: vscode
- name: Install apt packages
  become: yes
  apt:
    name: "{{ packages }}"
  vars:
    packages:
    - code
    - dia
    - fonts-noto
    - freecad
    - google-chrome-stable
    - inkscape
    - keepass2
    - meld
    - obs-studio
    - wireshark
- name: Clone source-code-pro font repo
  git:
    repo: https://github.com/adobe-fonts/source-code-pro.git
    version: 29fdb884c6e9dc2a312f4a5e2bb3b2dad2350777
    refspec: release
    dest: "{{ lookup('env','HOME') }}/.local/share/source-code-pro"
- name: Install source-code-pro fonts
  synchronize:
    src: "{{ lookup('env','HOME') }}/.local/share/source-code-pro/OTF/"
    dest: "{{ lookup('env','HOME') }}/.fonts/"
- name: Download Ubuntu Mono Nerd Font
  get_url:
    url: https://github.com/ryanoasis/nerd-fonts/releases/download/v2.2.2/UbuntuMono.zip
    dest: "{{ home }}/.local/share/UbuntuMono-Nerd.zip"
    checksum: sha256:6a5b0cf6ec7c20c93d3854d0ffa1f0944ad18d11b6574d057b401ece63f64c56
  register: ubuntu_nerd
- name: Install Ubuntu Mono Nerd Font
  unarchive:
    src: "{{ ubuntu_nerd.dest }}"
    dest: "{{ home }}/.fonts"
  when: ubuntu_nerd.changed
  register: ubuntu_nerd_install
- name: Update font cache
  shell: fc-cache -fv
  when: ubuntu_nerd_install.changed
- name: "Install cargo packages"
  community.general.cargo:
    name: "{{ item }}"
    state: latest
  loop:
    - alacritty
